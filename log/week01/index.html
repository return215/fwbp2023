<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="The task at hand is to create a working Windows Forms application. It should be able to receive user input through form controls and update the form accordingly.
For this WinForms project, I decided to implement a rhythm game score converter, where it will change the scoring system based on the type of game selected.
The biggest challenge, however, is not making the form to work, but to make the data I create to initialize properly." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://fwbp2023.return215.xyz/log/week01/" />


    <title>
        
            Week 1: WinForms Application :: Framework Stories 
        
    </title>





<link rel="stylesheet" href="/main.b78c3be9451dc4ca61ca377f3dc2cf2e6345a44c2bae46216a322ef366daa399.css" integrity="sha256-t4w76UUdxMphyjd/PcLPLmNFpEwrrkYhajIu82bao5k=">



    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="Week 1: WinForms Application">
<meta itemprop="description" content="The task at hand is to create a working Windows Forms application. It should be able to receive user input through form controls and update the form accordingly.
For this WinForms project, I decided to implement a rhythm game score converter, where it will change the scoring system based on the type of game selected.
The biggest challenge, however, is not making the form to work, but to make the data I create to initialize properly."><meta itemprop="datePublished" content="2023-09-03T06:06:06+07:00" />
<meta itemprop="dateModified" content="2023-10-21T18:18:58+07:00" />
<meta itemprop="wordCount" content="1063">
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Week 1: WinForms Application"/>
<meta name="twitter:description" content="The task at hand is to create a working Windows Forms application. It should be able to receive user input through form controls and update the form accordingly.
For this WinForms project, I decided to implement a rhythm game score converter, where it will change the scoring system based on the type of game selected.
The biggest challenge, however, is not making the form to work, but to make the data I create to initialize properly."/>







    <meta property="article:published_time" content="2023-09-03 06:06:06 &#43;0700 &#43;0700" />











    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text ">
                FrameworkStories()</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about">About</a></li><li><a href="/log">Blog</a></li>
        <div class="submenu">
            <li class="dropdown">
                <a href="javascript:void(0)" class="dropbtn">en</a>
                <div class="dropdown-content">
                    
                        
                            <a title="id" href="http://fwbp2023.return215.xyz/id/log/week01/">id</a>
                        
                    
                </div>
            </li>
        </div>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
                Also available in
                
                    <a href="http://fwbp2023.return215.xyz/id/log/week01/"><span class="flag fi fi-id"></span></a>
                
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="http://fwbp2023.return215.xyz/log/week01/">Week 1: WinForms Application</a></h2>

            
            
            

            <div class="post-content">
                <p>The task at hand is to create a working Windows Forms application. It should be able to receive user input through form controls and update the form accordingly.</p>
<p>For this WinForms project, I decided to implement a rhythm game score converter, where it will change the scoring system based on the type of game selected.</p>
<p>The biggest challenge, however, is not making the form to work, but to make the data I create to initialize properly. You see, I had experience with C# before, but that was 6 years ago, when I was making <a href="https://github.com/HDX13-BeatCode/MathBeat.Unity">a basic rhythm game in Unity</a>. I had picked up the language again for a bit when taking the Web Programming course a while back. We were told to create an ASP.NET Core full-stack application with it. However, there is no public code for that. Sorry.</p>
<p>The code for this week&rsquo;s project can be seen on <a href="https://github.com/return215/fwbp2023-winforms/tree/master/WinForms-01">my GitHub repository</a>.</p>
<h2 id="creating-the-project">Creating the Project</h2>
<p>Creating a new project in Visual Studio 2022 is as simple as ever.</p>
<p><img src="01_project.png" alt="Selecting Windows Forms application when creating a new project"></p>
<p><img src="02_dotnet6.png" alt="Selecting .NET 6.0 LTS when creating the project (Visual Studio was not responding when trying to take a screenshot, hence it has a white overlay)"></p>
<p>After creating the project, I initialized a Git repository and pushed it onto my GitHub. Dragging the layout was straightforward as well. The IDE is a bit slow because of my low-end CPU, and my 8GB RAM for this Windows 10 VM isn&rsquo;t helping much. Otherwise, I managed to write a code that works. Or so I thought.</p>
<p>But before we get there, let&rsquo;s talk about the data I use and how I structure them.</p>
<h2 id="the-scoring-data">The Scoring Data</h2>
<p>The scoring data is made of the following structure:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">Name</span>: <span style="color:#ae81ff">name of score system</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">Judgements</span>: <span style="color:#75715e"># list of Judge values</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">Name</span>: <span style="color:#ae81ff">name of judge 1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Value</span>: <span style="color:#ae81ff">2</span> <span style="color:#75715e"># weight value of judge</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Used</span>: <span style="color:#66d9ef">true</span> <span style="color:#75715e"># whether the judge is used or not</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">Name</span>: <span style="color:#ae81ff">name of judge 2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Value</span>: <span style="color:#ae81ff">1</span> <span style="color:#75715e"># weight value of judge</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Used</span>: <span style="color:#66d9ef">true</span> <span style="color:#75715e"># whether the judge is used or not</span>
</span></span></code></pre></div><p>The structure is then implemented in C# accordingly as <a href="https://github.com/return215/fwbp2023-winforms/blob/master/WinForms-01/ScoringSystem.cs"><code>ScoringSystem</code></a> and <a href="https://github.com/return215/fwbp2023-winforms/blob/master/WinForms-01/JudgeValue.cs"><code>JudgeValue</code></a> for the list of judgements. More details can be seen on the respective source files.</p>
<p>Also in <code>ScoringSystem</code>, I added a method to <code>CalculateScore</code> given a set of numbers that correspond to each judgement. The function returns a tuple of two double-precision floating point numbers: a raw score, and a normalized score in the range of 0 to 1 inclusive.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> (<span style="color:#66d9ef">double</span>, <span style="color:#66d9ef">double</span>) CalculateScore(<span style="color:#66d9ef">int</span>[] judgeCounts) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> score = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> maxWeight = <span style="color:#66d9ef">double</span>.MinValue;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> totalNotes = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i = <span style="color:#ae81ff">0</span>; i &lt; Judgements.Count; i++)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">var</span> judge = Judgements[i];
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> (i &gt;= judgeCounts.Length) <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> (!judge.Used) <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		maxWeight = Math.Max(maxWeight, judge.Value);
</span></span><span style="display:flex;"><span>		score += judge.Value * judgeCounts[i];
</span></span><span style="display:flex;"><span>		totalNotes += judgeCounts[i];
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> normalizedScore = score / maxWeight / totalNotes;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> (score, normalizedScore);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The code will iterate through each Judgement and its respective count. If either of the list ends, the calculation stops. If the judge is not used, then it will not count towards the score.</p>
<p>The calculation takes the product of the respective judge&rsquo;s value and its count, then sums it up, while tracking the total count and the maximum weight given in the scoring system. The <code>score</code> is the raw value as above, meanwhile the <code>normalizedScore</code> is calculated after score and is divided by the maximum weight and the total count.</p>
<p>The data is stored in the <a href="https://github.com/return215/fwbp2023-winforms/blob/master/WinForms-01/ScoringData.cs"><code>ScoringData</code></a> class, initializing the list of scoring systems and its judge values. The numbers are based from various sources:</p>
<ul>
<li><a href="http://aaronin.jp/ddrallcalc.html">Dance Dance Revolution Dance Level Calculator</a></li>
<li>Waterfall Theme for StepMania/ITG</li>
<li>CHUNITHM</li>
</ul>
<p>For DDRMAX, I am using the MIGS variant to better reflect the accuracy when getting a Marvelous judgement.</p>
<p>However, when trying to use these values, I made a mistake that causes the form to not run.</p>
<h2 id="the-dreaded-nullreferenceexception">The Dreaded <code>NullReferenceException</code></h2>
<p>When trying to load data from the <code>ScoringData</code> object, it threw <code>NullReferenceException</code>. In other words, my program tried to access <code>Systems</code> field, but it was <code>null</code>, therefore crashing the program. Initially I thought I initialize the <code>ComboBox</code> wrong, but it turns out I was doing it right already.</p>
<p><img src="03_init_problem.png" alt="The NullReferenceException caused by line 21 in ScoringData when initializing Systems field"></p>
<p>The problem was actually where I tried to initialize <code>Judgements</code> list. Simply assigning a value there won&rsquo;t create the object, so I fixed that by creating the list object.</p>
<p><img src="04_fix_problem.png" alt="Add object initializer to Judgements"></p>
<p>After modifying the data source (which is just pre-instantiated data), the form finally worked well.</p>
<h2 id="the-form">The Form</h2>
<p>The form consists of several fields:</p>
<ul>
<li>1 <code>ComboBox</code> to select preferred scoring system to use,</li>
<li>9 <code>NumericUpDown</code> fields to enter the numbers, and</li>
<li>2 <code>Label</code>s to show the score.</li>
</ul>
<p>Depending on the game, some judgements may not be used, indicated by the <code>Used</code> field in each <code>Judgement</code> entry. To reflect this, the respective <code>NumericUpDown</code> field is disabled (<code>.Enabled = false</code>). I also do some sanity checks to disable any other fields that may not have a corresponding <code>Judgement</code>, but I do not demonstrate it here, since my data covers all of the fields so far.</p>
<p>By default, <code>NumericUpDown</code> has a maximum value of 100. I do not want this, therefore I want to change it. The way I do it is to open up the <code>Form1.Designer.cs</code>, the file that is intended to be used for the graphical layout designer, and add the entry manually referencing to <code>decimal.MaxValue</code> to each of the number box. This way, I don&rsquo;t need to change the numbers manually and it will be safe as it follows system implementation.</p>
<p>I make the form update its views whenever the value in the <code>ComboBox</code> changes or any of the <code>NumericUpDown</code> fields changes. This will take the count input and calculate the score (with the maximum score of 1.000.000) and the raw score (which directly correlates to the original weighted values of each <code>Judgement</code>).</p>
<p><img src="05_demo_initial.png" alt="Initial demo of blank form"></p>
<p>The input value is based on the following video:</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/4CSm5ZWR6Nw" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<p>And here is the resulting input. Note that the two Fantastic entries are added together here.</p>
<p><img src="06_demo_itg.png" alt="Demo using In The Groove scoring"></p>
<p><img src="07_demo_wf.png" alt="Demo using In Waterfall scoring"></p>
<p><img src="08_demo_ddrex.png" alt="Demo using DanceDanceRevolution EX scoring"></p>
<p><img src="09_demo_chunithm.png" alt="Demo using CHUNITHM scoring"></p>
<p><img src="10_demo_ddrmax.png" alt="Demo using DanceDanceRevolution MAX DP scoring">
The DDRMAX case is weird, because for some reason Hold OK worth three times as Perfect (I mistyped it as Excellent), and that is treated as the maximum weight.</p>
<h2 id="whats-next">What&rsquo;s Next</h2>
<p>This is just a proof-of-concept that I am able to create a working WinForms app. The business logic still needs improving, as it is the case with DDRMAX. For example, I could separate the tracking for regular notes and hold notes so that the score would show correctly.</p>
<p>But I will leave it there for this week and perhaps polish it the next week, depending on the topic to be covered later.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
			    <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"></circle><line x1="1.05" y1="12" x2="7" y2="12"></line><line x1="17.01" y1="12" x2="22.96" y2="12"></line></svg><a href="3e0baf86dc6e10b8ed0bc7daca36dfae753115a5" target="_blank" rel="noopener">3e0baf8</a> @ 2023-10-21</p>
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.205d491810c28f95aa953fae884e1c27abe13fdf93ec63b882d0036b248d4a6282eb2d134e4e7225c6ad6e86db87b08488a361ca4a7383d01fcff43f3d57b9c3.js" integrity="sha512-IF1JGBDCj5WqlT&#43;uiE4cJ6vhP9&#43;T7GO4gtADaySNSmKC6y0TTk5yJcatbobbh7CEiKNhykpzg9Afz/Q/PVe5ww=="></script>



    </body>
</html>
